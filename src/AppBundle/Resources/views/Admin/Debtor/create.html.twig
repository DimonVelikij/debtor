{% extends '@SonataAdmin/CRUD/base_edit.html.twig' %}

{% block form %}
    <div class="sonata-ba-form" ng-controller="DebtorCreateCtrl">
        <script type="text/ng-init" name="Path">{{ {
                AdminDebtorTypes: path('admin_app_debtor_types')
            } |json_encode | raw }}</script>
        <form name="debtor">
            <div class="row">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-12">
                            <div class="box box-primary">
                                <div class="box-header">
                                    <h4>Должники</h4>
                                </div>
                                <div class="box-body">
                                    <div class="sonata-ba-collapsed-fields">
                                        <div class="form-group" ng-class="{'has-error': debtor.type.$invalid && debtor.type.$dirty}">
                                            <label for="type" class="control-label required">Тип должника</label>
                                            <select name="type" id="type" ng-model="formData.debtorType" ng-options="debtorType as debtorType.title for debtorType in debtorTypes" required backend>
                                                <option value="">--Выберите тип должника--</option>
                                            </select>
                                            <div class="help-block sonata-ba-field-error-messages" ng-if="debtor.type.$invalid && debtor.type.$dirty" ng-messages="debtor.type.$error">
                                                <ul class="list-unstyled">
                                                    <li ng-message="required"><i class="fa fa-exclamation-circle"></i>Выберите тип должника</li>
                                                    <li ng-message="backend"><i class="fa fa-exclamation-circle"></i>[[ debtor.type.errorMessages.backend ]]</li>
                                                </ul>
                                            </div>
                                        </div>
                                        <div ng-if="formData.debtorType.alias == 'individual'">
                                            {#форма#}
                                        </div>
                                        <div ng-if="formData.debtorType.alias == 'businessman'">
                                            {#форма#}
                                        </div>
                                        <div ng-if="formData.debtorType.alias == 'legal_entity'">
                                            {#форма#}
                                        </div>
                                    </div>
                                </div>
                                <button ng-click="submit($event, debtor)">Сохранить</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
{% endblock %}

{% block sonata_javascript_pool %}
    {{ parent() }}
    {% javascripts
        '@cms_debtor'
    %}
    <script type="text/javascript" src="{{ asset(asset_url, 'js') }}"></script>
    {% endjavascripts %}
{% endblock %}
